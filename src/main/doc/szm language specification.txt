水沝淼语言规范

水沝淼是一个基于栈的语言，所有指令均由“水、沝、淼”三个字组成，无视其他任何字符，各指令含义与jvm字节码类似。


数值的声明：
数的定义是二进制的整数，水=1, 沝=0, 淼=结束
具体定义与java相同
(二进制)max=1111111111111111111111111111111
(二进制)min=10000000000000000000000000000000

指令可分为六大类：
1：局部和全局变量的加载和储存
2：操作栈的管理
3：数值运算
4：流程控制
5：IO流的输入与输出
6：保留指令（暂时无用）

注意：
以下出现的指令均为助记符，实际指令另见
所有的参数都是数值，n表示指令后必须带参数。

一、局部和全局变量的加载和储存
load  n
复制指定局部变量的值，并将复制值压入栈顶
store  n
将栈顶数值出栈，并将其存入一个局部变量
g_load  n
复制指定全局变量的值，并将复制值压入栈顶
g_store  n
将栈顶数值出栈，并将其存入一个全局变量

二、操作栈的管理
push n
推送常量至栈顶
pop
将栈顶数值弹出
dup
复制栈顶元素并将复制值压入栈顶
swap
交换操作数栈顶的两个值

三、数值运算
add
将栈顶两数值相加并将结果压入栈顶
sub
将栈顶两数值相减并将结果压入栈顶，先入栈的元素将被视为运算子左方的算子
mul
将栈顶两数值相乘并将结果压入栈顶
div
将栈顶两数值相除并将结果压入栈顶，先入栈的元素将被视为运算子左方的算子
rem
将栈顶两数值作取模运算并将结果压入栈顶，先入栈的元素将被视为运算子左方的算子
cmp
比较栈顶两数值大小，并将结果（>:1，=:0，<:-1）压入栈顶,先入栈的元素将被视为运算子左方的算子

shl  n
将栈顶数值左移位n位数并将结果压入栈顶
shr  n
将栈顶数值右(带符号)移位n位数并将结果压入栈顶
ushr  n
将栈顶数值右(无符号)移位n位数并将结果压入栈顶
not
将栈顶数作“按位非”并将结果压入栈顶
and
将栈顶两数值作“按位与”并将结果压入栈顶
or
将栈顶两数值作“按位或”并将结果压入栈顶
xor
将栈顶两数值作“按位异或”并将结果压入栈顶

四、流程控制
fun  n
创建函数。主方法默认从头开始，到第一个函数声明结束；其他函数从声明处开始，到下一个函数声明或文件结尾处结束
mark  n
创建标签
_goto  n
无条件跳转，只能跳转本函数内标签
ifeq  n
将栈顶数字出栈，当其等于0时跳转，只能跳转本函数内标签
iflt  n
将栈顶数字出栈，当其小于0时跳转，只能跳转本函数内标签
ifgt  n
将栈顶数字出栈，当其大于0时跳转，只能跳转本函数内标签
invoke  n
调用函数
_return
从当前方法返回
exit  n
无条件结束程序,0表示正常结束，1表示异常结束

五、IO流的输入与输出
outs
弹出栈顶数字作为字符输出
outn
弹出栈顶数字以数字形式输出
reads
从输入内读取一个字符，然后将其值压入栈顶
readn
从输入内读取一个数字（回车结束)，然后将其值压入栈顶

六、保留指令
breakpoint
目前不可用，未来或用于实现断点调试
impdep1
目前不可用，未来可能由用户自己实现